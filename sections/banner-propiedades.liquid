{% comment %}
  Sección Hero con filtros: Tipo vivienda (casa, depto, terreno, bodega) y Venta/Renta
{% endcomment %}

<section class="hero-search-wrapper-{{ section.id }}">
  <div class="hero-bg">
    {% if section.settings.background_image != blank %}
      <img
        src="{{ section.settings.background_image | image_url: width: 2000 }}"
        alt="{{ section.settings.heading | escape }}"
      >
    {% endif %}
    <div class="hero-overlay"></div>
  </div>

  <div class="hero-content">
    {% if section.settings.heading != blank %}
      <h1 class="hero-heading">{{ section.settings.heading }}</h1>
    {% endif %}

    {% if section.settings.subheading != blank %}
      <p class="hero-subheading">{{ section.settings.subheading }}</p>
    {% endif %}

    <form class="hero-search-form" action="{{ section.settings.form_action | default: '/collections/all' }}" method="get">
      <!-- Select Venta/Renta -->
      <select name="{{ section.settings.param_venta | default: 'venta' }}" id="venta-select-{{ section.id }}">
        <option value="">{{ section.settings.label_venta_default | default: 'Venta/Renta' }}</option>
        <option value="{{ section.settings.option_venta_1_value | default: 'venta' }}">{{ section.settings.option_venta_1_label | default: 'Venta' }}</option>
        <option value="{{ section.settings.option_venta_2_value | default: 'renta' }}">{{ section.settings.option_venta_2_label | default: 'Renta' }}</option>
      </select>

      <!-- Select Tipo de vivienda -->
      <select name="{{ section.settings.param_tipo | default: 'tipo' }}" id="tipo-select-{{ section.id }}">
        <option value="">{{ section.settings.label_tipo_default | default: 'Tipo de vivienda' }}</option>
        <option value="{{ section.settings.option_tipo_1_value | default: 'casa' }}">{{ section.settings.option_tipo_1_label | default: 'Casa' }}</option>
        <option value="{{ section.settings.option_tipo_2_value | default: 'departamento' }}">{{ section.settings.option_tipo_2_label | default: 'Departamento' }}</option>
        <option value="{{ section.settings.option_tipo_3_value | default: 'terreno' }}">{{ section.settings.option_tipo_3_label | default: 'Terreno' }}</option>
        <option value="{{ section.settings.option_tipo_4_value | default: 'bodega' }}">{{ section.settings.option_tipo_4_label | default: 'Bodega' }}</option>
      </select>

      <!-- Campo de búsqueda -->
      <input
        type="search"
        name="{{ section.settings.param_busqueda | default: 'q' }}"
        id="search-input-{{ section.id }}"
        placeholder="{{ section.settings.placeholder_busqueda | default: 'Buscar por ubicación, dirección...' }}"
        autocomplete="off"
      >

      <!-- Botón -->
      <button type="submit" class="hero-search-button">
        {{ section.settings.boton_texto | default: 'Buscar' }}
      </button>
    </form>
  </div>
</section>

<script>
function handleSearch(event, form) {
  const sectionId = form.closest('.hero-search-wrapper-').className.match(/hero-search-wrapper-(\S+)/)[1];
  const venta = document.getElementById('venta-select-' + sectionId).value;
  const tipo = document.getElementById('tipo-select-' + sectionId).value;
  const q = document.getElementById('search-input-' + sectionId).value.trim();

  if (!venta && !tipo && !q) {
    window.location.href = '/collections/all';
    return false;
  }
  return true;
}
</script>

<style>
  /* Estilos base - mismo diseño responsive */
  .hero-search-wrapper-{{ section.id }} {
    position: relative;
    overflow: hidden;
    min-height: {{ section.settings.altura_desktop }}vh;
    color: #ffffff;
  }

  /* ... resto de estilos del hero (bg, overlay, content, heading, subheading) igual que antes ... */

  .hero-search-form {
    display: grid;
    grid-template-columns: 1fr 1fr 2fr auto;
    gap: 0;
    background: rgba(255,255,255,0.95);
    border-radius: 999px;
    overflow: hidden;
    max-width: 900px;
    margin: 0 auto;
  }

  .hero-search-form select,
  .hero-search-form input {
    border: none;
    padding: 12px 14px;
    font-size: 14px;
    outline: none;
    color: {{ section.settings.search_textcolor | default: '#333333' }};
  }

  .hero-search-form select {
    border-right: 1px solid #e0e0e0;
    background: white;
  }

  .hero-search-form input {
    background: white;
  }

  .hero-search-form input::placeholder {
    color: {{ section.settings.search_placeholder_color | default: '#999999' }};
  }

  .hero-search-button {
    border: none;
    padding: 0 24px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    background: {{ section.settings.button_color | default: '#3c7a4a' }};
    color: {{ section.settings.button_text_color | default: '#ffffff' }};
    white-space: nowrap;
    transition: all 0.2s ease;
  }

  .hero-search-button:hover,
  .hero-search-button:active {
    filter: brightness(0.9);
    transform: translateY(-1px);
  }

  /* Responsive */
  @media (max-width: 900px) {
    .hero-search-wrapper-{{ section.id }} {
      min-height: {{ section.settings.altura_mobile }}vh;
    }
    .hero-search-form {
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      border-radius: 20px;
      gap: 1px;
    }
    .hero-search-form input {
      grid-column: 1 / -1;
      border-top: 1px solid #e0e0e0;
    }
  }
</style>

{% schema %}
{
  "name": "Hero Búsqueda Inmuebles",
  "settings": [
    /* ... todos los settings previos del hero ... */
    
    /* Configuración Venta/Renta */
    {
      "type": "text",
      "id": "label_venta_default",
      "label": "Texto por defecto Venta/Renta",
      "default": "Venta/Renta"
    },
    {
      "type": "text",
      "id": "option_venta_1_label",
      "label": "Opción 1 etiqueta (ej. Venta)",
      "default": "Venta"
    },
    {
      "type": "text",
      "id": "option_venta_1_value",
      "label": "Opción 1 valor",
      "default": "venta"
    },
    {
      "type": "text",
      "id": "option_venta_2_label",
      "label": "Opción 2 etiqueta (ej. Renta)",
      "default": "Renta"
    },
    {
      "type": "text",
      "id": "option_venta_2_value",
      "label": "Opción 2 valor",
      "default": "renta"
    },
    {
      "type": "text",
      "id": "param_venta",
      "label": "Nombre del parámetro Venta/Renta",
      "default": "venta"
    },

    /* Configuración Tipo vivienda */
    {
      "type": "text",
      "id": "label_tipo_default",
      "label": "Texto por defecto Tipo vivienda",
      "default": "Tipo de vivienda"
    },
    {
      "type": "text",
      "id": "option_tipo_1_label",
      "label": "Tipo 1 (Casa)",
      "default": "Casa"
    },
    {
      "type": "text",
      "id": "option_tipo_1_value",
      "label": "Tipo 1 valor",
      "default": "casa"
    },
    {
      "type": "text",
      "id": "option_tipo_2_label",
      "label": "Tipo 2 (Departamento)",
      "default": "Departamento"
    },
    {
      "type": "text",
      "id": "option_tipo_2_value",
      "label": "Tipo 2 valor",
      "default": "departamento"
    },
    {
      "type": "text",
      "id": "option_tipo_3_label",
      "label": "Tipo 3 (Terreno)",
      "default": "Terreno"
    },
    {
      "type": "text",
      "id": "option_tipo_3_value",
      "label": "Tipo 3 valor",
      "default": "terreno"
    },
    {
      "type": "text",
      "id": "option_tipo_4_label",
      "label": "Tipo 4 (Bodega)",
      "default": "Bodega"
    },
    {
      "type": "text",
      "id": "option_tipo_4_value",
      "label": "Tipo 4 valor",
      "default": "bodega"
    },
    {
      "type": "text",
      "id": "param_tipo",
      "label": "Nombre del parámetro Tipo vivienda",
      "default": "tipo"
    },

    /* ... resto de settings (form_action, placeholder_busqueda, boton_texto, colores, etc.) ... */
  ],
  "presets": [{
    "name": "Hero Búsqueda Inmuebles"
  }]
}
{% endschema %}
