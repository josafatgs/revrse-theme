{% comment %}
  Sección: Hero con barra de búsqueda de propiedades
{% endcomment %}

<section class="hero-search-wrapper-{{ section.id }}">
  <div class="hero-search-bg">
    {% if section.settings.background_image != blank %}
      <img
        src="{{ section.settings.background_image | image_url: width: 2000 }}"
        alt="{{ section.settings.heading | escape }}">
    {% endif %}
    <div class="hero-search-overlay"></div>
  </div>

  <div class="hero-search-content">
    {% if section.settings.heading != blank %}
      <h1 class="hero-search-heading">
        {{ section.settings.heading }}
      </h1>
    {% endif %}

    {% if section.settings.subheading != blank %}
      <p class="hero-search-subheading">
        {{ section.settings.subheading }}
      </p>
    {% endif %}

    <form
      class="hero-search-form"
      action="{{ section.settings.form_action | default: '/collections/all' }}"
      method="get"
      onsubmit="return handleSearch(event, this)"
    >
      <!-- Select Venta / Renta -->
      <select name="{{ section.settings.param_venta | default: 'venta' }}" id="venta-select">
        <option value="">{{ section.settings.label_venta_default }}</option>
        {% if section.settings.option_venta_1_label != blank %}
          <option value="{{ section.settings.option_venta_1_value }}">{{ section.settings.option_venta_1_label }}</option>
        {% endif %}
        {% if section.settings.option_venta_2_label != blank %}
          <option value="{{ section.settings.option_venta_2_value }}">{{ section.settings.option_venta_2_label }}</option>
        {% endif %}
      </select>

      <!-- Select Tipo de inmueble -->
      <select name="{{ section.settings.param_tipo | default: 'tipo' }}" id="tipo-select">
        <option value="">{{ section.settings.label_tipo_default }}</option>
        {% if section.settings.option_tipo_1_label != blank %}
          <option value="{{ section.settings.option_tipo_1_value }}">{{ section.settings.option_tipo_1_label }}</option>
        {% endif %}
        {% if section.settings.option_tipo_2_label != blank %}
          <option value="{{ section.settings.option_tipo_2_value }}">{{ section.settings.option_tipo_2_label }}</option>
        {% endif %}
        {% if section.settings.option_tipo_3_label != blank %}
          <option value="{{ section.settings.option_tipo_3_value }}">{{ section.settings.option_tipo_3_label }}</option>
        {% endif %}
      </select>

      <!-- Campo texto -->
      <input
        type="search"
        name="{{ section.settings.param_busqueda | default: 'q' }}"
        id="search-input"
        placeholder="{{ section.settings.placeholder_busqueda }}"
        autocomplete="off"
      >

      <!-- Botón -->
      <button type="submit" class="hero-search-button">
        {{ section.settings.boton_texto }}
      </button>
    </form>
  </div>
</section>

<script>
function handleSearch(event, form) {
  const venta = document.getElementById('venta-select').value;
  const tipo = document.getElementById('tipo-select').value;
  const q = document.getElementById('search-input').value.trim();
  
  if (!venta && !tipo && !q) {
    window.location.href = '/collections/all';  // O 'https://cainmobiliaria.mx/collections/all'
    return false;
  }
  return true;
}
</script>

<style>
  /* Tus estilos originales aquí, con estas mejoras móviles */
  .hero-search-wrapper-{{ section.id }} {
    position: relative;
    overflow: hidden;
    min-height: {{ section.settings.altura_desktop }}vh;
    color: #ffffff;
  }

  /* ... resto de estilos iguales hasta media queries ... */

  @media (max-width: 900px) {
    .hero-search-wrapper-{{ section.id }} {
      min-height: {{ section.settings.altura_mobile }}vh;
    }

    .hero-search-form {
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      border-radius: 20px; /* Suavizado */
      gap: 1px; /* Separación sutil */
    }

    .hero-search-form input {
      grid-column: 1 / -1;
      border-top: 1px solid #e0e0e0;
      padding: 16px 16px; /* Más toque móvil */
    }

    .hero-search-button {
      grid-column: 1 / -1;
      margin-top: 0;
      padding: 16px 0;
      border-radius: 0 0 20px 20px;
      font-size: 16px; /* Legible en touch */
    }
  }

  @media (max-width: 600px) {
    .hero-search-heading {
      font-size: {{ section.settings.heading_size_mobile }}px;
    }
    .hero-search-subheading {
      font-size: {{ section.settings.subheading_size_mobile }}px;
    }
    .hero-search-content {
      padding: 50px 12px 30px; /* Compacto para pantallas pequeñas */
    }

    .hero-search-form {
      grid-template-columns: 1fr;
      border-radius: 16px;
      max-width: 100%;
    }

    .hero-search-form select,
    .hero-search-form input,
    .hero-search-button {
      border-radius: 0;
      border-bottom: 1px solid #e0e0e0;
      padding: 18px 16px; /* Thumb-friendly */
      font-size: 16px; /* iOS Safari mínimo */
    }

    .hero-search-button {
      border-bottom: none;
      border-radius: 0 0 16px 16px;
      background: {{ section.settings.button_color }};
    }
  }

  /* Transición suave para mejor UX móvil */
  .hero-search-button {
    transition: all 0.2s ease;
  }
  .hero-search-button:hover,
  .hero-search-button:active {
    filter: brightness(0.9);
    transform: translateY(-1px); /* Feedback táctil */
  }
</style>
